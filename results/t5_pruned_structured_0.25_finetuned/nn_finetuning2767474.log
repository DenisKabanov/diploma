Status: 
      DATA_DIR: ./data/
      RESULTS_DIR: ./results/
      MODELS_DIR: ./models/
      MODEL_NAME: t5_pruned_structured_0.25
      DATASET_NAME_HF: aiana94/polynews-parallel
      DATASET_NAME_LOC: polynews-parallel
      MAX_SEQUENCE_LEN: 256
      FP16: False
      RANDOM_STATE: 42
      TEST_SIZE: 0.2
      TEST_MAX_SAMPLES: 35289
      TRAIN_MAX_SAMPLES: 141152
      EPOCHS: 20
      EPOCHS_PATIENCE: 3
      LEARNING_RATE: 1e-05
      BATCH_SIZE: 16
      DEVICE: cuda:0
      
Модель по пути ./models/t5_pruned_structured_0.25 уже была сохранена ранее, используем её!
Число обучаемых параметров: 110724480 из 110724480, то есть ~100.00%.
Датасет по пути ./data/polynews-parallel уже был сохранён ранее, используем его!
Датасет по пути ./data/polynews-parallel_t5_processed уже был сохранён ранее, используем его!
{'loss': 0.5377, 'grad_norm': 0.9283239245414734, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.4162236750125885, 'eval_bleu': 0.22277, 'eval_mean_len': 28.10408, 'eval_runtime': 9151.8481, 'eval_samples_per_second': 3.856, 'eval_steps_per_second': 0.241, 'epoch': 1.0}
{'loss': 0.4573, 'grad_norm': 0.7650773525238037, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.39688053727149963, 'eval_bleu': 0.23531, 'eval_mean_len': 28.32676, 'eval_runtime': 9126.6286, 'eval_samples_per_second': 3.867, 'eval_steps_per_second': 0.242, 'epoch': 2.0}
{'loss': 0.432, 'grad_norm': 0.8658775091171265, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.386373907327652, 'eval_bleu': 0.24101, 'eval_mean_len': 28.3437, 'eval_runtime': 8879.648, 'eval_samples_per_second': 3.974, 'eval_steps_per_second': 0.248, 'epoch': 3.0}
{'loss': 0.4169, 'grad_norm': 0.6993263363838196, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.38045161962509155, 'eval_bleu': 0.24562, 'eval_mean_len': 28.50061, 'eval_runtime': 8962.8282, 'eval_samples_per_second': 3.937, 'eval_steps_per_second': 0.246, 'epoch': 4.0}
{'loss': 0.406, 'grad_norm': 0.8243992924690247, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.3756648004055023, 'eval_bleu': 0.24937, 'eval_mean_len': 28.5368, 'eval_runtime': 8858.7443, 'eval_samples_per_second': 3.984, 'eval_steps_per_second': 0.249, 'epoch': 5.0}
{'loss': 0.3973, 'grad_norm': 0.7680492401123047, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.37324050068855286, 'eval_bleu': 0.24958, 'eval_mean_len': 28.44784, 'eval_runtime': 8820.7266, 'eval_samples_per_second': 4.001, 'eval_steps_per_second': 0.25, 'epoch': 6.0}
{'loss': 0.3908, 'grad_norm': 0.7760890126228333, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.3706134259700775, 'eval_bleu': 0.25275, 'eval_mean_len': 28.51985, 'eval_runtime': 8823.5312, 'eval_samples_per_second': 3.999, 'eval_steps_per_second': 0.25, 'epoch': 7.0}
{'loss': 0.3851, 'grad_norm': 0.6542938351631165, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.36840033531188965, 'eval_bleu': 0.25377, 'eval_mean_len': 28.55111, 'eval_runtime': 8673.1348, 'eval_samples_per_second': 4.069, 'eval_steps_per_second': 0.254, 'epoch': 8.0}
{'loss': 0.3805, 'grad_norm': 0.4926655888557434, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.3674214780330658, 'eval_bleu': 0.25551, 'eval_mean_len': 28.63051, 'eval_runtime': 8123.2103, 'eval_samples_per_second': 4.344, 'eval_steps_per_second': 0.272, 'epoch': 9.0}
{'loss': 0.3764, 'grad_norm': 0.5859254598617554, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.3662163019180298, 'eval_bleu': 0.25567, 'eval_mean_len': 28.58089, 'eval_runtime': 8774.8125, 'eval_samples_per_second': 4.022, 'eval_steps_per_second': 0.251, 'epoch': 10.0}
{'loss': 0.3733, 'grad_norm': 0.7172689437866211, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.3640759289264679, 'eval_bleu': 0.25627, 'eval_mean_len': 28.6557, 'eval_runtime': 8745.2414, 'eval_samples_per_second': 4.035, 'eval_steps_per_second': 0.252, 'epoch': 11.0}
{'loss': 0.3702, 'grad_norm': 0.8445826768875122, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.3639565408229828, 'eval_bleu': 0.25656, 'eval_mean_len': 28.56026, 'eval_runtime': 9026.0883, 'eval_samples_per_second': 3.91, 'eval_steps_per_second': 0.244, 'epoch': 12.0}
{'loss': 0.3678, 'grad_norm': 0.7953009009361267, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.3624720275402069, 'eval_bleu': 0.25705, 'eval_mean_len': 28.61302, 'eval_runtime': 7964.2852, 'eval_samples_per_second': 4.431, 'eval_steps_per_second': 0.277, 'epoch': 13.0}
{'loss': 0.3656, 'grad_norm': 0.8129853010177612, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.36219632625579834, 'eval_bleu': 0.25776, 'eval_mean_len': 28.6338, 'eval_runtime': 7615.1033, 'eval_samples_per_second': 4.634, 'eval_steps_per_second': 0.29, 'epoch': 14.0}
{'loss': 0.3639, 'grad_norm': 0.8786973357200623, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.36184048652648926, 'eval_bleu': 0.25831, 'eval_mean_len': 28.60772, 'eval_runtime': 7621.2271, 'eval_samples_per_second': 4.63, 'eval_steps_per_second': 0.289, 'epoch': 15.0}
{'loss': 0.3623, 'grad_norm': 0.7011297941207886, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.36198660731315613, 'eval_bleu': 0.25832, 'eval_mean_len': 28.57443, 'eval_runtime': 8094.1147, 'eval_samples_per_second': 4.36, 'eval_steps_per_second': 0.273, 'epoch': 16.0}
{'loss': 0.3614, 'grad_norm': 0.6720798015594482, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.36109501123428345, 'eval_bleu': 0.25837, 'eval_mean_len': 28.63909, 'eval_runtime': 8089.5223, 'eval_samples_per_second': 4.362, 'eval_steps_per_second': 0.273, 'epoch': 17.0}
{'loss': 0.3605, 'grad_norm': 0.5440699458122253, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.36113572120666504, 'eval_bleu': 0.25859, 'eval_mean_len': 28.62351, 'eval_runtime': 8124.8605, 'eval_samples_per_second': 4.343, 'eval_steps_per_second': 0.272, 'epoch': 18.0}
{'loss': 0.3596, 'grad_norm': 0.7471930384635925, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.36103394627571106, 'eval_bleu': 0.25866, 'eval_mean_len': 28.63552, 'eval_runtime': 8005.8013, 'eval_samples_per_second': 4.408, 'eval_steps_per_second': 0.276, 'epoch': 19.0}
{'loss': 0.3592, 'grad_norm': 0.6818009614944458, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.3609713912010193, 'eval_bleu': 0.25868, 'eval_mean_len': 28.64675, 'eval_runtime': 8368.8243, 'eval_samples_per_second': 4.217, 'eval_steps_per_second': 0.264, 'epoch': 20.0}
{'train_runtime': 223229.4932, 'train_samples_per_second': 12.646, 'train_steps_per_second': 0.79, 'train_loss': 0.39119246921093925, 'epoch': 20.0}
Время, затраченное на обучение: 223229.74126386642 секунд.
