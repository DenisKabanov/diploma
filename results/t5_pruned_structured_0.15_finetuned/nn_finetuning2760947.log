Status: 
      DATA_DIR: ./data/
      RESULTS_DIR: ./results/
      MODELS_DIR: ./models/
      MODEL_NAME: t5_pruned_structured_0.15
      DATASET_NAME_HF: aiana94/polynews-parallel
      DATASET_NAME_LOC: polynews-parallel
      MAX_SEQUENCE_LEN: 256
      FP16: False
      RANDOM_STATE: 42
      TEST_SIZE: 0.2
      TEST_MAX_SAMPLES: 35289
      TRAIN_MAX_SAMPLES: 141152
      EPOCHS: 20
      EPOCHS_PATIENCE: 3
      LEARNING_RATE: 1e-05
      BATCH_SIZE: 16
      DEVICE: cuda:0
      
Модель по пути ./models/t5_pruned_structured_0.15 уже была сохранена ранее, используем её!
Число обучаемых параметров: 110724480 из 110724480, то есть ~100.00%.
Датасет по пути ./data/polynews-parallel уже был сохранён ранее, используем его!
Датасет по пути ./data/polynews-parallel_t5_processed уже был сохранён ранее, используем его!
{'loss': 0.4295, 'grad_norm': 0.8722323775291443, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.36986014246940613, 'eval_bleu': 0.25138, 'eval_mean_len': 28.53801, 'eval_runtime': 8622.7311, 'eval_samples_per_second': 4.093, 'eval_steps_per_second': 0.256, 'epoch': 1.0}
{'loss': 0.3932, 'grad_norm': 0.6610144972801208, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.3620661795139313, 'eval_bleu': 0.25732, 'eval_mean_len': 28.73011, 'eval_runtime': 8980.8453, 'eval_samples_per_second': 3.929, 'eval_steps_per_second': 0.246, 'epoch': 2.0}
{'loss': 0.3797, 'grad_norm': 0.7730243802070618, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.357311487197876, 'eval_bleu': 0.25928, 'eval_mean_len': 28.7064, 'eval_runtime': 10500.4879, 'eval_samples_per_second': 3.361, 'eval_steps_per_second': 0.21, 'epoch': 3.0}
{'loss': 0.3709, 'grad_norm': 0.6769825220108032, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.3545193076133728, 'eval_bleu': 0.26179, 'eval_mean_len': 28.77033, 'eval_runtime': 10349.1107, 'eval_samples_per_second': 3.41, 'eval_steps_per_second': 0.213, 'epoch': 4.0}
{'loss': 0.3642, 'grad_norm': 0.753984272480011, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.35242655873298645, 'eval_bleu': 0.26362, 'eval_mean_len': 28.70393, 'eval_runtime': 10399.1738, 'eval_samples_per_second': 3.393, 'eval_steps_per_second': 0.212, 'epoch': 5.0}
{'loss': 0.3588, 'grad_norm': 0.6885327100753784, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.3516175448894501, 'eval_bleu': 0.26317, 'eval_mean_len': 28.67426, 'eval_runtime': 10397.5648, 'eval_samples_per_second': 3.394, 'eval_steps_per_second': 0.212, 'epoch': 6.0}
{'loss': 0.3544, 'grad_norm': 0.7282854318618774, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.3503865599632263, 'eval_bleu': 0.26531, 'eval_mean_len': 28.75669, 'eval_runtime': 10428.0739, 'eval_samples_per_second': 3.384, 'eval_steps_per_second': 0.212, 'epoch': 7.0}
{'loss': 0.3505, 'grad_norm': 0.6474664211273193, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.3493870496749878, 'eval_bleu': 0.26577, 'eval_mean_len': 28.75607, 'eval_runtime': 10416.2608, 'eval_samples_per_second': 3.388, 'eval_steps_per_second': 0.212, 'epoch': 8.0}
{'loss': 0.3474, 'grad_norm': 0.42054641246795654, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.34917500615119934, 'eval_bleu': 0.26685, 'eval_mean_len': 28.82187, 'eval_runtime': 10294.3329, 'eval_samples_per_second': 3.428, 'eval_steps_per_second': 0.214, 'epoch': 9.0}
{'loss': 0.3445, 'grad_norm': 0.5845875144004822, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.34868475794792175, 'eval_bleu': 0.26708, 'eval_mean_len': 28.74927, 'eval_runtime': 9843.8179, 'eval_samples_per_second': 3.585, 'eval_steps_per_second': 0.224, 'epoch': 10.0}
{'loss': 0.3424, 'grad_norm': 0.6737647652626038, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.3471229374408722, 'eval_bleu': 0.26745, 'eval_mean_len': 28.77707, 'eval_runtime': 9753.3929, 'eval_samples_per_second': 3.618, 'eval_steps_per_second': 0.226, 'epoch': 11.0}
{'loss': 0.34, 'grad_norm': 0.8099014163017273, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.34756532311439514, 'eval_bleu': 0.26745, 'eval_mean_len': 28.77293, 'eval_runtime': 9769.6222, 'eval_samples_per_second': 3.612, 'eval_steps_per_second': 0.226, 'epoch': 12.0}
{'loss': 0.3384, 'grad_norm': 0.7299010157585144, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.3462512493133545, 'eval_bleu': 0.26739, 'eval_mean_len': 28.77112, 'eval_runtime': 9748.5568, 'eval_samples_per_second': 3.62, 'eval_steps_per_second': 0.226, 'epoch': 13.0}
{'loss': 0.3368, 'grad_norm': 0.7509260773658752, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.34648698568344116, 'eval_bleu': 0.26793, 'eval_mean_len': 28.79351, 'eval_runtime': 9769.0963, 'eval_samples_per_second': 3.612, 'eval_steps_per_second': 0.226, 'epoch': 14.0}
{'loss': 0.3356, 'grad_norm': 0.703185498714447, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.34648457169532776, 'eval_bleu': 0.26868, 'eval_mean_len': 28.76814, 'eval_runtime': 9806.649, 'eval_samples_per_second': 3.598, 'eval_steps_per_second': 0.225, 'epoch': 15.0}
{'loss': 0.3343, 'grad_norm': 0.7080656290054321, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.3464948832988739, 'eval_bleu': 0.26861, 'eval_mean_len': 28.76996, 'eval_runtime': 9142.7638, 'eval_samples_per_second': 3.86, 'eval_steps_per_second': 0.241, 'epoch': 16.0}
{'loss': 0.3341, 'grad_norm': 0.6808876395225525, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.345756471157074, 'eval_bleu': 0.26867, 'eval_mean_len': 28.78784, 'eval_runtime': 9559.3367, 'eval_samples_per_second': 3.692, 'eval_steps_per_second': 0.231, 'epoch': 17.0}
{'loss': 0.3335, 'grad_norm': 0.5136129260063171, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.3460814654827118, 'eval_bleu': 0.26846, 'eval_mean_len': 28.77667, 'eval_runtime': 9507.2442, 'eval_samples_per_second': 3.712, 'eval_steps_per_second': 0.232, 'epoch': 18.0}
{'train_runtime': 225285.6628, 'train_samples_per_second': 12.531, 'train_steps_per_second': 0.783, 'train_loss': 0.3548988010388525, 'epoch': 18.0}
Время, затраченное на обучение: 225285.89420890808 секунд.
