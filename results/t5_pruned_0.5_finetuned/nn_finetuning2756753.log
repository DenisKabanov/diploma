Status: 
      DATA_DIR: ./data/
      RESULTS_DIR: ./results/
      MODELS_DIR: ./models/
      MODEL_NAME: t5_pruned_0.5
      DATASET_NAME_HF: aiana94/polynews-parallel
      DATASET_NAME_LOC: polynews-parallel
      MAX_SEQUENCE_LEN: 256
      FP16: False
      RANDOM_STATE: 42
      TEST_SIZE: 0.2
      TEST_MAX_SAMPLES: 35289
      TRAIN_MAX_SAMPLES: 141152
      EPOCHS: 20
      EPOCHS_PATIENCE: 3
      LEARNING_RATE: 1e-05
      BATCH_SIZE: 16
      DEVICE: cuda:0
      
Модель по пути ./models/t5_pruned_0.5 уже была сохранена ранее, используем её!
Число обучаемых параметров: 110724480 из 110724480, то есть ~100.00%.
Датасет по пути ./data/polynews-parallel уже был сохранён ранее, используем его!
Датасет по пути ./data/polynews-parallel_t5_processed уже был сохранён ранее, используем его!
{'loss': 0.4054, 'grad_norm': 0.7785037159919739, 'learning_rate': 9.5e-06, 'epoch': 1.0}
{'eval_loss': 0.36958789825439453, 'eval_bleu': 0.24982, 'eval_mean_len': 29.159, 'eval_runtime': 8019.153, 'eval_samples_per_second': 4.401, 'eval_steps_per_second': 0.275, 'epoch': 1.0}
{'loss': 0.383, 'grad_norm': 0.6048534512519836, 'learning_rate': 9e-06, 'epoch': 2.0}
{'eval_loss': 0.3640352487564087, 'eval_bleu': 0.25525, 'eval_mean_len': 29.21001, 'eval_runtime': 9058.3048, 'eval_samples_per_second': 3.896, 'eval_steps_per_second': 0.244, 'epoch': 2.0}
{'loss': 0.373, 'grad_norm': 0.690693199634552, 'learning_rate': 8.5e-06, 'epoch': 3.0}
{'eval_loss': 0.36026450991630554, 'eval_bleu': 0.2569, 'eval_mean_len': 29.13171, 'eval_runtime': 9331.6927, 'eval_samples_per_second': 3.782, 'eval_steps_per_second': 0.236, 'epoch': 3.0}
{'loss': 0.3661, 'grad_norm': 0.714848518371582, 'learning_rate': 8.000000000000001e-06, 'epoch': 4.0}
{'eval_loss': 0.35847368836402893, 'eval_bleu': 0.25959, 'eval_mean_len': 29.17238, 'eval_runtime': 8051.085, 'eval_samples_per_second': 4.383, 'eval_steps_per_second': 0.274, 'epoch': 4.0}
{'loss': 0.3604, 'grad_norm': 0.7532609701156616, 'learning_rate': 7.500000000000001e-06, 'epoch': 5.0}
{'eval_loss': 0.3572700321674347, 'eval_bleu': 0.26067, 'eval_mean_len': 29.09997, 'eval_runtime': 7970.827, 'eval_samples_per_second': 4.427, 'eval_steps_per_second': 0.277, 'epoch': 5.0}
{'loss': 0.3558, 'grad_norm': 0.7124835252761841, 'learning_rate': 7e-06, 'epoch': 6.0}
{'eval_loss': 0.35646864771842957, 'eval_bleu': 0.26085, 'eval_mean_len': 29.0618, 'eval_runtime': 8830.2464, 'eval_samples_per_second': 3.996, 'eval_steps_per_second': 0.25, 'epoch': 6.0}
{'loss': 0.3521, 'grad_norm': 0.6483376622200012, 'learning_rate': 6.5000000000000004e-06, 'epoch': 7.0}
{'eval_loss': 0.35570254921913147, 'eval_bleu': 0.26282, 'eval_mean_len': 29.15158, 'eval_runtime': 8758.5844, 'eval_samples_per_second': 4.029, 'eval_steps_per_second': 0.252, 'epoch': 7.0}
{'loss': 0.3486, 'grad_norm': 0.6608219742774963, 'learning_rate': 6e-06, 'epoch': 8.0}
{'eval_loss': 0.3547123968601227, 'eval_bleu': 0.26281, 'eval_mean_len': 29.08088, 'eval_runtime': 9321.0593, 'eval_samples_per_second': 3.786, 'eval_steps_per_second': 0.237, 'epoch': 8.0}
{'loss': 0.3458, 'grad_norm': 0.4324454069137573, 'learning_rate': 5.500000000000001e-06, 'epoch': 9.0}
{'eval_loss': 0.35442593693733215, 'eval_bleu': 0.26466, 'eval_mean_len': 29.16733, 'eval_runtime': 9304.0992, 'eval_samples_per_second': 3.793, 'eval_steps_per_second': 0.237, 'epoch': 9.0}
{'loss': 0.3432, 'grad_norm': 0.49597489833831787, 'learning_rate': 5e-06, 'epoch': 10.0}
{'eval_loss': 0.3543601632118225, 'eval_bleu': 0.26454, 'eval_mean_len': 29.09921, 'eval_runtime': 8647.3218, 'eval_samples_per_second': 4.081, 'eval_steps_per_second': 0.255, 'epoch': 10.0}
{'loss': 0.3413, 'grad_norm': 0.6782834529876709, 'learning_rate': 4.5e-06, 'epoch': 11.0}
{'eval_loss': 0.35299918055534363, 'eval_bleu': 0.26422, 'eval_mean_len': 29.13644, 'eval_runtime': 8250.7708, 'eval_samples_per_second': 4.277, 'eval_steps_per_second': 0.267, 'epoch': 11.0}
{'loss': 0.3392, 'grad_norm': 0.7980403900146484, 'learning_rate': 4.000000000000001e-06, 'epoch': 12.0}
{'eval_loss': 0.3536599576473236, 'eval_bleu': 0.26494, 'eval_mean_len': 29.08549, 'eval_runtime': 8471.5654, 'eval_samples_per_second': 4.166, 'eval_steps_per_second': 0.26, 'epoch': 12.0}
{'loss': 0.3376, 'grad_norm': 0.7036600112915039, 'learning_rate': 3.5e-06, 'epoch': 13.0}
{'eval_loss': 0.35235750675201416, 'eval_bleu': 0.26497, 'eval_mean_len': 29.11244, 'eval_runtime': 8245.3194, 'eval_samples_per_second': 4.28, 'eval_steps_per_second': 0.268, 'epoch': 13.0}
{'loss': 0.3362, 'grad_norm': 0.8328338861465454, 'learning_rate': 3e-06, 'epoch': 14.0}
{'eval_loss': 0.35262006521224976, 'eval_bleu': 0.26553, 'eval_mean_len': 29.13633, 'eval_runtime': 8795.5859, 'eval_samples_per_second': 4.012, 'eval_steps_per_second': 0.251, 'epoch': 14.0}
{'loss': 0.3349, 'grad_norm': 0.6934901475906372, 'learning_rate': 2.5e-06, 'epoch': 15.0}
{'eval_loss': 0.3525194823741913, 'eval_bleu': 0.26502, 'eval_mean_len': 29.11967, 'eval_runtime': 9125.6853, 'eval_samples_per_second': 3.867, 'eval_steps_per_second': 0.242, 'epoch': 15.0}
{'loss': 0.3338, 'grad_norm': 0.7270544767379761, 'learning_rate': 2.0000000000000003e-06, 'epoch': 16.0}
{'eval_loss': 0.3526206612586975, 'eval_bleu': 0.26567, 'eval_mean_len': 29.10695, 'eval_runtime': 9266.9083, 'eval_samples_per_second': 3.808, 'eval_steps_per_second': 0.238, 'epoch': 16.0}
{'loss': 0.334, 'grad_norm': 0.794944167137146, 'learning_rate': 1.5e-06, 'epoch': 17.0}
{'eval_loss': 0.3519514501094818, 'eval_bleu': 0.26528, 'eval_mean_len': 29.10454, 'eval_runtime': 9244.2572, 'eval_samples_per_second': 3.817, 'eval_steps_per_second': 0.239, 'epoch': 17.0}
{'loss': 0.3332, 'grad_norm': 0.5729631781578064, 'learning_rate': 1.0000000000000002e-06, 'epoch': 18.0}
{'eval_loss': 0.3523159325122833, 'eval_bleu': 0.26574, 'eval_mean_len': 29.10442, 'eval_runtime': 9206.8069, 'eval_samples_per_second': 3.833, 'eval_steps_per_second': 0.24, 'epoch': 18.0}
{'loss': 0.3325, 'grad_norm': 0.739016056060791, 'learning_rate': 5.000000000000001e-07, 'epoch': 19.0}
{'eval_loss': 0.3521937429904938, 'eval_bleu': 0.26557, 'eval_mean_len': 29.10516, 'eval_runtime': 9118.0757, 'eval_samples_per_second': 3.87, 'eval_steps_per_second': 0.242, 'epoch': 19.0}
{'loss': 0.3324, 'grad_norm': 0.605176568031311, 'learning_rate': 0.0, 'epoch': 20.0}
{'eval_loss': 0.35219305753707886, 'eval_bleu': 0.26574, 'eval_mean_len': 29.12077, 'eval_runtime': 9137.4491, 'eval_samples_per_second': 3.862, 'eval_steps_per_second': 0.241, 'epoch': 20.0}
{'train_runtime': 229593.6973, 'train_samples_per_second': 12.296, 'train_steps_per_second': 0.768, 'train_loss': 0.3494216562641691, 'epoch': 20.0}
Время, затраченное на обучение: 229593.88998913765 секунд.
